<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>InfoHealth AI ‚Äì General Medicine</title>
  <link rel="icon" href="infohealth-logo.png" />
  <style>
    * { box-sizing: border-box; }
    
    /* Splash Screen Styles */
    .splash-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000000;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      opacity: 1;
      transition: opacity 1s ease-out;
    }
    
    .splash-screen.fade-out {
      opacity: 0;
      pointer-events: none;
    }
    
    .splash-logo {
      width: 200px;
      height: auto;
      margin-bottom: 20px;
      animation: logoFloat 2s ease-in-out infinite alternate;
      filter: drop-shadow(0 10px 20px rgba(218, 165, 32, 0.3));
    }
    
    .splash-title {
      color: #DAA520;
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 10px;
      text-align: center;
      text-shadow: 0 2px 10px rgba(218, 165, 32, 0.5);
      animation: titleGlow 2s ease-in-out infinite alternate;
    }
    
    .splash-subtitle {
      color: #ffffff;
      font-size: 1.1rem;
      font-weight: 300;
      text-align: center;
      margin-bottom: 40px;
      opacity: 0.9;
    }
    
    .splash-loader {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(218, 165, 32, 0.3);
      border-top: 4px solid #DAA520;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    .splash-progress {
      margin-top: 20px;
      color: #DAA520;
      font-size: 0.9rem;
      font-weight: 500;
    }
    
    @keyframes logoFloat {
      0% { transform: translateY(0px); }
      100% { transform: translateY(-10px); }
    }
    
    @keyframes titleGlow {
      0% { text-shadow: 0 2px 10px rgba(218, 165, 32, 0.5); }
      100% { text-shadow: 0 2px 20px rgba(218, 165, 32, 0.8); }
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Main App Initially Hidden */
    .main-app {
      opacity: 0;
      transition: opacity 1s ease-in;
    }
    
    .main-app.show {
      opacity: 1;
    }

    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #1a1a1a 0%, #2c2c2c 25%, #3c3c3c 50%, #2a2a2a 75%, #000000 100%);
      min-height: 100vh;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .mobile-frame {
      width: 100%;
      max-width: 420px;
      height: 95vh;
      max-height: 900px;
      background: linear-gradient(145deg, #000000 0%, #1a1a1a 50%, #2c2c2c 100%);
      border-radius: 35px;
      padding: 8px;
      box-shadow: 
        0 25px 50px rgba(0, 0, 0, 0.6),
        0 0 0 1px rgba(255, 255, 255, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.1),
        0 0 30px rgba(218, 165, 32, 0.2);
      position: relative;
      overflow: hidden;
    }

    .mobile-frame::before {
      content: '';
      position: absolute;
      top: 15px;
      left: 50%;
      transform: translateX(-50%);
      width: 120px;
      height: 4px;
      background: linear-gradient(90deg, #333 0%, #555 50%, #333 100%);
      border-radius: 2px;
      z-index: 10;
    }

    .wrapper {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      background: white;
      border-radius: 27px;
      overflow: hidden;
      box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.1);
    }

    .header {
      background: linear-gradient(135deg, #000000 0%, #1a1a1a 50%, #2c2c2c 100%);
      padding: 1rem 1rem 0.5rem 1rem;
      text-align: center;
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
      overflow: hidden;
    }
    
    .header img {
      height: 80px;
      max-width: 90%;
      object-fit: contain;
      display: block;
      margin: 0 auto;
      filter: drop-shadow(0 2px 8px rgba(0,0,0,0.5));
      position: relative;
      z-index: 1;
    }

    .cards-container {
      background: #f8f9fa;
      padding: 0.5rem;
      border-bottom: 2px solid #e0e0e0;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .cards-section {
      margin-bottom: 0.4rem;
      position: relative;
      border-radius: 8px;
      overflow: hidden;
      background: #f8f9fa;
    }
    
    .cards-section:last-child {
      margin-bottom: 0;
    }
    
    .cards-section h3 {
      margin: 0 0 0.3rem 0;
      color: #333;
      font-size: 0.7rem;
      text-transform: uppercase;
      font-weight: 600;
      letter-spacing: 0.5px;
      padding: 0.5rem;
      background: rgba(255,255,255,0.9);
      backdrop-filter: blur(5px);
    }

    .cards {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 0.25rem;
      padding: 0 0.5rem 0.5rem 0.5rem;
    }
    .card {
      background: rgba(255,255,255,0.95);
      padding: 0.4rem 0.2rem;
      border-radius: 4px;
      text-align: center;
      font-size: 0.65rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: 0 1px 2px rgba(0,0,0,0.1);
      border: 1px solid #e0e0e0;
      min-height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #333;
      line-height: 1.1;
      backdrop-filter: blur(5px);
    }

    .card:hover { 
      transform: translateY(-1px); 
      box-shadow: 0 2px 4px rgba(0,0,0,0.15);
      border-color: #DAA520;
      background: rgba(255,255,255,1);
    }

    .chat {
      flex: 1;
      padding: 1rem !important;
      overflow-y: auto;
      background: white;
      scroll-behavior: smooth;
      display: flex;
      flex-direction: column;
    }
    .bubble-wrapper {
      display: flex;
      gap: 0.4rem;
      margin-bottom: 0.8rem;
      align-items: flex-end;
    }
    .bubble-wrapper.user {
      flex-direction: row-reverse;
    }
    .avatar img {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      object-fit: cover;
      background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
      padding: 2px;
      border: 1px solid rgba(218, 165, 32, 0.3);
    }
    .message {
      padding: 0.8rem 1rem;
      border-radius: 12px;
      max-width: 85%;
      line-height: 1.6;
      font-size: 0.95rem;
      word-wrap: break-word;
    }
    
    .message ul, .message ol {
      margin: 0.5rem 0;
      padding-left: 1rem;
    }
    
    .message li {
      margin-bottom: 0.2rem;
      line-height: 1.3;
    }
    
    .message p {
      margin: 0.5rem 0;
      line-height: 1.4;
    }
    
    .message strong {
      display: block;
      margin: 0.6rem 0 0.3rem 0;
      color: #DAA520;
      font-weight: 700;
      font-size: 0.95rem;
      border-bottom: 1px solid #e0e0e0;
      padding-bottom: 0.2rem;
    }
    .user .message {
      background: linear-gradient(135deg, #6B7280 0%, #4B5563 100%);
      color: white;
      box-shadow: 0 2px 8px rgba(107, 114, 128, 0.3);
    }
    .bot .message {
      background: #f8f9fa;
      color: #333;
      border: 1px solid #e0e0e0;
    }

    .input-area {
      display: flex;
      padding: 0.8rem;
      background: white;
      border-top: 1px solid #e0e0e0;
    }
    .input-area input {
      flex: 1;
      padding: 0.6rem;
      border-radius: 20px;
      border: 1px solid #e0e0e0;
      outline: none;
      font-size: 0.9rem;
    }
    .input-area input:focus {
      border-color: #DAA520;
    }
    .input-area button {
      margin-left: 0.6rem;
      background: linear-gradient(135deg, #DAA520 0%, #B8860B 100%);
      color: white;
      border: none;
      padding: 0.6rem 1rem;
      border-radius: 20px;
      cursor: pointer;
      font-weight: 500;
      font-size: 0.9rem;
      box-shadow: 0 2px 8px rgba(218, 165, 32, 0.3);
    }

    .medical-image {
      max-width: 300px;
      max-height: 200px;
      width: 100%;
      height: auto;
      border-radius: 8px;
      margin: 10px 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    /* Health Management Modal Styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 10000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.8);
    }

    .modal-content {
      background-color: white;
      margin: 2% auto;
      padding: 20px;
      border-radius: 15px;
      width: 90%;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
      position: relative;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }

    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      position: absolute;
      right: 15px;
      top: 10px;
    }

    .close:hover {
      color: #DAA520;
    }

    .modal h2 {
      color: #DAA520;
      margin-bottom: 20px;
      border-bottom: 2px solid #DAA520;
      padding-bottom: 10px;
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 600;
      color: #333;
    }

    .form-group input, .form-group select, .form-group textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 14px;
    }

    .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
      border-color: #DAA520;
      outline: none;
    }

    .btn {
      background: linear-gradient(135deg, #DAA520 0%, #B8860B 100%);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 500;
      margin-right: 10px;
      margin-bottom: 10px;
    }

    .btn:hover {
      background: linear-gradient(135deg, #B8860B 0%, #DAA520 100%);
    }

    .btn-secondary {
      background: #6B7280;
    }

    .btn-secondary:hover {
      background: #4B5563;
    }

    .home-btn {
      margin-left: 0.6rem;
      background: #6B7280;
      color: white;
      border: none;
      padding: 0.6rem 1rem;
      border-radius: 20px;
      cursor: pointer;
      font-weight: 500;
      font-size: 0.9rem;
      box-shadow: 0 2px 8px rgba(107, 114, 128, 0.3);
    }

    .home-btn:hover {
      background: #4B5563;
    }

    .health-card {
      background: #f8f9fa;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
    }

    .health-card h4 {
      margin: 0 0 10px 0;
      color: #DAA520;
    }

    .reading-entry {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr auto;
      gap: 10px;
      align-items: center;
      padding: 10px;
      background: white;
      border-radius: 6px;
      margin-bottom: 10px;
    }

    .delete-btn {
      background: #dc3545;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
    }

    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 2px;
      margin-top: 15px;
    }

    .calendar-day {
      padding: 10px;
      text-align: center;
      border: 1px solid #eee;
      cursor: pointer;
      background: white;
    }

    .calendar-day:hover {
      background: #f0f8ff;
    }

    .calendar-day.selected {
      background: #DAA520;
      color: white;
    }

    .calendar-day.has-event {
      background: #e8f5e8;
      border-color: #28a745;
    }

    /* Responsive adjustments */
    @media (max-width: 450px) {
      body {
        padding: 10px;
      }
      .mobile-frame {
        max-width: 100%;
        height: 95vh;
        border-radius: 25px;
      }
      .wrapper {
        border-radius: 17px;
      }
      .modal-content {
        width: 95%;
        margin: 5% auto;
        padding: 15px;
      }
      .reading-entry {
        grid-template-columns: 1fr 1fr;
        gap: 5px;
      }
    }
  </style>
</head>
<body>
  <!-- Splash Screen -->
  <div class="splash-screen" id="splashScreen">
    <img src="infohealth-logo.png" alt="InfoHealth AI Logo" class="splash-logo">
    <h1 class="splash-title">InfoHealth AI</h1>
    <p class="splash-subtitle">Your Intelligent Health Companion</p>
    <div class="splash-loader"></div>
    <p class="splash-progress">Loading your health dashboard...</p>
  </div>

  <!-- Main App -->
  <div class="main-app" id="mainApp">
    <div class="mobile-frame">
    <div class="wrapper">
      <div class="header">
        <img src="infohealth-logo.png" alt="InfoHealth AI Logo" style="height: 80px; max-width: 90%; object-fit: contain;">
      </div>

      <div class="cards-container">
        <div class="cards-section" id="section1">
          <h3>Medical Conditions</h3>
          <div class="cards">
            <div class="card" onclick="sendMessageWithClear('What is hypertension and how is it treated?')">Hypertension</div>
            <div class="card" onclick="sendMessageWithClear('Explain high cholesterol causes and treatments')">Cholesterol</div>
            <div class="card" onclick="sendMessageWithClear('What is heart disease and how is it managed?')">Heart Disease</div>
            <div class="card" onclick="sendMessageWithClear('What is diabetes and how do I manage blood sugar?')">Diabetes</div>
          </div>
        </div>

        <div class="cards-section" id="section2">
          <h3>Health Management</h3>
          <div class="cards">
            <div class="card" onclick="showHealthCalendar()">Calendar</div>
            <div class="card" onclick="showMyHealthInfo()">My Info</div>
            <div class="card" onclick="showAppointments()">Appointments</div>
            <div class="card" onclick="showMedications()">Medications</div>
          </div>
        </div>
      </div>

      <div class="chat" id="chatBox">
        <!-- Chat messages will appear here -->
      </div>

      <div class="input-area">
        <input type="text" id="userInput" placeholder="Ask a medical question..." />
        <button onclick="sendMessage()">Send</button>
        <button class="home-btn" onclick="goHome()">üè† Home</button>
      </div>
    </div>
      </div>
    </div>
  </div>

  <!-- Health Management Modals -->
  
  <!-- Health Calendar Modal -->
  <div id="calendarModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal('calendarModal')">&times;</span>
      <h2>üìÖ Health Calendar & Tracking</h2>
      
      <div class="form-group">
        <label>Quick Health Reading Entry:</label>
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr auto; gap: 10px;">
          <input type="text" id="readingValue" placeholder="Reading (e.g., 140/90)">
          <select id="readingType">
            <option value="Blood Pressure">Blood Pressure</option>
            <option value="Blood Sugar">Blood Sugar</option>
            <option value="Weight">Weight</option>
            <option value="Heart Rate">Heart Rate</option>
          </select>
          <input type="datetime-local" id="readingTime">
          <button class="btn" onclick="addHealthReading()">Add</button>
        </div>
      </div>

      <div class="health-card">
        <h4>Recent Health Readings</h4>
        <div id="healthReadings"></div>
      </div>

      <div class="health-card">
        <h4>Health Goals This Week</h4>
        <div class="form-group">
          <input type="text" id="newGoal" placeholder="Add a health goal...">
          <button class="btn" onclick="addHealthGoal()">Add Goal</button>
        </div>
        <div id="healthGoals"></div>
        <button class="btn-secondary" onclick="goHome()" style="margin-top: 15px;">üè† Back to Home</button>
      </div>
    </div>
  </div>

  <!-- My Health Info Modal -->
  <div id="healthInfoModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal('healthInfoModal')">&times;</span>
      <h2>üìã My Health Information</h2>
      
      <div class="health-card">
        <h4>Personal Information</h4>
        <div class="form-group">
          <label>Full Name:</label>
          <input type="text" id="fullName" placeholder="Enter your full name">
        </div>
        <div class="form-group">
          <label>Date of Birth:</label>
          <input type="date" id="dateOfBirth">
        </div>
        <div class="form-group">
          <label>Emergency Contact:</label>
          <input type="text" id="emergencyContact" placeholder="Name and phone number">
        </div>
      </div>

      <div class="health-card">
        <h4>Medical Conditions</h4>
        <div class="form-group">
          <input type="text" id="newCondition" placeholder="Add medical condition...">
          <button class="btn" onclick="addMedicalCondition()">Add</button>
        </div>
        <div id="medicalConditions"></div>
      </div>

      <div class="health-card">
        <h4>Allergies</h4>
        <div class="form-group">
          <input type="text" id="newAllergy" placeholder="Add allergy...">
          <button class="btn" onclick="addAllergy()">Add</button>
        </div>
        <div id="allergiesList"></div>
      </div>

      <div class="health-card">
        <h4>Target Health Numbers</h4>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
          <div class="form-group">
            <label>Blood Pressure Goal:</label>
            <input type="text" id="bpGoal" placeholder="e.g., <130/80">
          </div>
          <div class="form-group">
            <label>Cholesterol Goal:</label>
            <input type="text" id="cholesterolGoal" placeholder="e.g., LDL <100">
          </div>
          <div class="form-group">
            <label>Blood Sugar Goal:</label>
            <input type="text" id="bsGoal" placeholder="e.g., HbA1c <7%">
          </div>
          <div class="form-group">
            <label>Weight Goal:</label>
            <input type="text" id="weightGoal" placeholder="e.g., 180 lbs">
          </div>
        </div>
      </div>

      <button class="btn" onclick="saveHealthInfo()">Save Information</button>
      <button class="btn-secondary" onclick="goHome()">üè† Back to Home</button>
    </div>
  </div>

  <!-- Appointments Modal -->
  <div id="appointmentsModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal('appointmentsModal')">&times;</span>
      <h2>üè• Medical Appointments</h2>
      
      <div class="health-card">
        <h4>Schedule New Appointment</h4>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
          <div class="form-group">
            <label>Doctor/Clinic:</label>
            <input type="text" id="doctorName" placeholder="Dr. Smith - Cardiologist">
          </div>
          <div class="form-group">
            <label>Date & Time:</label>
            <input type="datetime-local" id="appointmentTime">
          </div>
          <div class="form-group">
            <label>Appointment Type:</label>
            <select id="appointmentType">
              <option value="Regular Checkup">Regular Checkup</option>
              <option value="Follow-up">Follow-up</option>
              <option value="Lab Work">Lab Work</option>
              <option value="Specialist">Specialist</option>
              <option value="Emergency">Emergency</option>
            </select>
          </div>
          <div class="form-group">
            <label>Phone Number:</label>
            <input type="tel" id="doctorPhone" placeholder="(555) 123-4567">
          </div>
        </div>
        <div class="form-group">
          <label>Notes/Reason:</label>
          <textarea id="appointmentNotes" placeholder="Reason for visit, questions to ask, etc."></textarea>
        </div>
        <button class="btn" onclick="addAppointment()">Schedule Appointment</button>
      </div>

      <div class="health-card">
        <h4>Upcoming Appointments</h4>
        <div id="upcomingAppointments"></div>
      </div>

      <div class="health-card">
        <h4>Past Appointments</h4>
        <div id="pastAppointments"></div>
        <button class="btn-secondary" onclick="goHome()" style="margin-top: 15px;">üè† Back to Home</button>
      </div>
    </div>
  </div>

  <!-- Medications Modal -->
  <div id="medicationsModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal('medicationsModal')">&times;</span>
      <h2>üíä Medication Management</h2>
      
      <div class="health-card">
        <h4>Add New Medication</h4>
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
          <div class="form-group">
            <label>Medication Name:</label>
            <input type="text" id="medicationName" placeholder="Lisinopril">
          </div>
          <div class="form-group">
            <label>Dosage:</label>
            <input type="text" id="medicationDosage" placeholder="10mg">
          </div>
          <div class="form-group">
            <label>Frequency:</label>
            <select id="medicationFrequency">
              <option value="Once daily">Once daily</option>
              <option value="Twice daily">Twice daily</option>
              <option value="Three times daily">Three times daily</option>
              <option value="Four times daily">Four times daily</option>
              <option value="As needed">As needed</option>
            </select>
          </div>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
          <div class="form-group">
            <label>Time to Take:</label>
            <input type="time" id="medicationTime">
          </div>
          <div class="form-group">
            <label>Prescribing Doctor:</label>
            <input type="text" id="prescribingDoctor" placeholder="Dr. Johnson">
          </div>
          <div class="form-group">
            <label>Pharmacy:</label>
            <input type="text" id="pharmacy" placeholder="CVS Pharmacy">
          </div>
        </div>
        <div class="form-group">
          <label>Notes/Instructions:</label>
          <textarea id="medicationNotes" placeholder="Take with food, side effects, etc."></textarea>
        </div>
        <button class="btn" onclick="addMedication()">Add Medication</button>
      </div>

      <div class="health-card">
        <h4>Current Medications</h4>
        <div id="currentMedications"></div>
      </div>

      <div class="health-card">
        <h4>Medication Reminders</h4>
        <div id="medicationReminders">
          <p><strong>üí° Tip:</strong> Set phone alarms for your medication times!</p>
        </div>
        <button class="btn-secondary" onclick="goHome()" style="margin-top: 15px;">üè† Back to Home</button>
      </div>
    </div>
  </div>

  <script>
    // Splash Screen Logic
    window.addEventListener('load', function() {
      const splashScreen = document.getElementById('splashScreen');
      const mainApp = document.getElementById('mainApp');
      
      // Show splash screen for 3 seconds
      setTimeout(() => {
        splashScreen.classList.add('fade-out');
        mainApp.classList.add('show');
        
        // Remove splash screen from DOM after transition
        setTimeout(() => {
          splashScreen.style.display = 'none';
        }, 1000);
      }, 3000);
    });

    const chatBox = document.getElementById('chatBox');
    const userInput = document.getElementById('userInput');

    // Clear chat function
    function clearChat() {
      chatBox.innerHTML = '';
    }

    // Home function - clears chat and closes any open modals
    function goHome() {
      // Clear the chat
      clearChat();
      
      // Close any open modals
      const modals = document.querySelectorAll('.modal');
      modals.forEach(modal => {
        modal.style.display = 'none';
      });
      
      // Clear the input field
      userInput.value = '';
      
      // Show a clean welcome message
      setTimeout(() => {
        addBubble('üè† Welcome back to InfoHealth AI! Choose a medical condition above to learn more, or use the Health Management tools to track your health data. You can also ask me any medical questions.', 'bot', false);
      }, 100);
    }

    // Add message function with typewriter effect
    function addBubble(text, role, useTypewriter = false) {
      const wrap = document.createElement('div');
      wrap.className = 'bubble-wrapper ' + role;

      const avatar = role === 'user' 
        ? '/public/infohealth-user-logo.png'
        : '/public/infohealth-logo-small.png';

      wrap.innerHTML = '<div class="avatar"><img src="' + avatar + '" alt="' + role + '" /></div><div class="message"></div>';
      
      const messageDiv = wrap.querySelector('.message');
      chatBox.appendChild(wrap);

      // Add home button to bot responses (but not to the welcome message)
      const shouldAddHomeButton = role === 'bot' && !text.includes('üè† Welcome back');
      const finalText = shouldAddHomeButton ? text + '<br><br><div style="text-align: center; margin-top: 15px;"><button class="btn-secondary" onclick="goHome()" style="padding: 8px 16px; border-radius: 20px; font-size: 0.85rem;">üè† Back to Home</button></div>' : text;

      if (useTypewriter && role === 'bot') {
        // Typewriter effect for bot responses
        let i = 0;
        const speed = 10; // milliseconds per character
        
        function typeWriter() {
          if (i < finalText.length) {
            messageDiv.innerHTML = finalText.substring(0, i + 1);
            i++;
            setTimeout(typeWriter, speed);
            // Auto-scroll as we type
            chatBox.scrollTop = chatBox.scrollHeight;
          }
        }
        typeWriter();
      } else {
        // Instant display for user messages and welcome messages
        messageDiv.innerHTML = finalText;
        setTimeout(() => {
          chatBox.scrollTop = chatBox.scrollHeight;
        }, 100);
      }
    }

    function getMedicalResponse(query) {
  const disclaimer = '<div style="background-color: #f0f8ff; border-left: 4px solid #DAA520; padding: 10px; margin-bottom: 15px; font-weight: bold; color: #2c5aa0;">‚ö†Ô∏è Consult healthcare professionals for medical advice.</div>';
  const queryLower = query.toLowerCase();

  // ========== HYPERTENSION CARD ==========
  if (queryLower.includes('hypertension') || queryLower.includes('blood pressure') || queryLower.includes('high bp')) {
    return disclaimer + `
    <img src="infohealth-professional-1.jpg" alt="Hypertension Management" class="medical-image">
    
    <strong>HYPERTENSION: COMPLETE CLINICAL GUIDE</strong><br><br>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
      <div>
        <strong>üìä Blood Pressure Classification (AHA 2023)</strong>
        <table style="width:100%; border-collapse: collapse; margin: 5px 0; font-size: 0.9rem;">
          <tr style="background-color: #f2f2f2;"><th>Category</th><th>Systolic</th><th>Diastolic</th></tr>
          <tr><td>Normal</td><td><120</td><td><80</td></tr>
          <tr><td>Elevated</td><td>120-129</td><td><80</td></tr>
          <tr><td>Stage 1</td><td>130-139</td><td>80-89</td></tr>
          <tr><td>Stage 2</td><td>‚â•140</td><td>‚â•90</td></tr>
          <tr style="background-color: #ffdddd;"><td>Crisis</td><td>>180</td><td>>120</td></tr>
        </table>
      </div>
      <div>
        <strong>üíä First-Line Medications</strong>
        <ul style="margin-top: 5px;">
          <li><strong>ACE Inhibitors:</strong> Lisinopril 10-40mg daily</li>
          <li><strong>ARBs:</strong> Losartan 50-100mg daily</li>
          <li><strong>CCBs:</strong> Amlodipine 5-10mg daily</li>
          <li><strong>Thiazides:</strong> HCTZ 12.5-25mg daily</li>
        </ul>
      </div>
    </div>

    <strong>üåø Evidence-Based Lifestyle Modifications</strong>
    <div style="background-color: #f8f9fa; padding: 10px; border-radius: 5px; margin: 10px 0;">
      <ul>
        <li><strong>DASH Diet:</strong> 8-10 servings fruits/vegetables daily (SBP‚Üì 8-14 mmHg)</li>
        <li><strong>Na+ Restriction:</strong> <2.3g/day (ideal 1.5g) (SBP‚Üì 5-6 mmHg)</li>
        <li><strong>Exercise:</strong> 150 mins/week moderate activity (SBP‚Üì 5-8 mmHg)</li>
        <li><strong>Weight Loss:</strong> 5-10% reduction (SBP‚Üì 5-20 mmHg per 10kg)</li>
      </ul>
    </div>

    <strong>üö® Hypertensive Emergency</strong>
    <div style="background-color: #fff3f5; padding: 10px; border-radius: 5px; margin: 10px 0;">
      BP >180/120 WITH end-organ damage:
      <ul>
        <li>Encephalopathy</li>
        <li>Retinal hemorrhages</li>
        <li>Pulmonary edema</li>
        <li>Aortic dissection</li>
      </ul>
      <em>Requires ICU admission and IV antihypertensives</em>
    </div>

    <strong>üìà Home Monitoring Protocol</strong>
    <ol style="margin: 10px 0; padding-left: 20px;">
      <li>Rest 5 mins in chair with back support</li>
      <li>Use validated upper-arm cuff</li>
      <li>Take 2-3 readings 1 min apart (AM/PM)</li>
      <li>Record all readings (not just averages)</li>
      <li>Bring log to all appointments</li>
    </ol>`;
  }

  // ========== CHOLESTEROL CARD ==========
  if (queryLower.includes('cholesterol') || queryLower.includes('ldl') || queryLower.includes('hdl')) {
    return disclaimer + `
    <img src="infohealth-professional-2.jpg" alt="Cholesterol Management" class="medical-image">
    
    <strong>LIPID MANAGEMENT: COMPLETE GUIDE</strong><br><br>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
      <div>
        <strong>üìä Lipid Targets (ACC 2023)</strong>
        <table style="width:100%; border-collapse: collapse; margin: 5px 0; font-size: 0.9rem;">
          <tr style="background-color: #f2f2f2;"><th>Parameter</th><th>Optimal</th><th>High Risk</th></tr>
          <tr><td>LDL-C</td><td><100</td><td><70</td></tr>
          <tr><td>Non-HDL-C</td><td><130</td><td><100</td></tr>
          <tr><td>ApoB</td><td><90</td><td><65</td></tr>
          <tr><td>Triglycerides</td><td><150</td><td><100</td></tr>
        </table>
      </div>
      <div>
        <strong>üíä Treatment Options</strong>
        <ul style="margin-top: 5px;">
          <li><strong>High-Intensity Statins:</strong> Atorvastatin 40-80mg (LDL‚Üì 50%)</li>
          <li><strong>Ezetimibe:</strong> 10mg daily (LDL‚Üì 15-20%)</li>
          <li><strong>PCSK9i:</strong> Evolocumab 140mg q2wk (LDL‚Üì 60%)</li>
          <li><strong>Bempedoic Acid:</strong> 180mg daily (LDL‚Üì 25%)</li>
        </ul>
      </div>
    </div>

    <strong>üçΩ Therapeutic Lifestyle Changes</strong>
    <div style="background-color: #f8f9fa; padding: 10px; border-radius: 5px; margin: 10px 0;">
      <ul>
        <li><strong>Soluble Fiber:</strong> 5-10g/day (LDL‚Üì 3-5%)</li>
        <li><strong>Plant Sterols:</strong> 2g/day (LDL‚Üì 6-15%)</li>
        <li><strong>Omega-3s:</strong> EPA+DHA 2-4g/day (TG‚Üì 20-40%)</li>
        <li><strong>Exercise:</strong> 200-300 mins/week (HDL‚Üë 5-10%)</li>
      </ul>
    </div>

    <strong>‚ö†Ô∏è Statin Intolerance Management</strong>
    <div style="background-color: #fff8e6; padding: 10px; border-radius: 5px; margin: 10px 0;">
      <ol>
        <li>Confirm true intolerance (muscle symptoms + CK elevation)</li>
        <li>Try alternate statin (e.g., fluvastatin XL)</li>
        <li>Consider every-other-day rosuvastatin</li>
        <li>Non-statin alternatives if persistent</li>
      </ol>
    </div>

    <strong>üîç Screening Recommendations</strong>
    <ul style="margin: 10px 0; padding-left: 20px;">
      <li><strong>All adults:</strong> Fasting lipid panel at least every 5 years</li>
      <li><strong>High risk:</strong> Annual testing</li>
      <li><strong>FH screening:</strong> LDL >190 mg/dL or premature CAD</li>
    </ul>`;
  }

  // ========== DIABETES CARD ==========
  if (queryLower.includes('diabetes') || queryLower.includes('blood sugar') || queryLower.includes('a1c')) {
    return disclaimer + `
    <img src="infohealth-professional-4.jpg" alt="Diabetes Management" class="medical-image">
    
    <strong>DIABETES MELLITUS: COMPLETE GUIDE</strong><br><br>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
      <div>
        <strong>üîç Diagnostic Criteria (ADA 2024)</strong>
        <table style="width:100%; border-collapse: collapse; margin: 5px 0; font-size: 0.9rem;">
          <tr style="background-color: #f2f2f2;"><th>Test</th><th>Prediabetes</th><th>Diabetes</th></tr>
          <tr><td>Fasting Glucose</td><td>100-125</td><td>‚â•126</td></tr>
          <tr><td>A1C</td><td>5.7-6.4%</td><td>‚â•6.5%</td></tr>
          <tr><td>OGTT</td><td>140-199</td><td>‚â•200</td></tr>
        </table>
      </div>
      <div>
        <strong>üéØ Treatment Targets</strong>
        <ul style="margin-top: 5px;">
          <li><strong>A1C:</strong> <7% (most adults)</li>
          <li><strong>Fasting:</strong> 80-130 mg/dL</li>
          <li><strong>Postprandial:</strong> <180 mg/dL</li>
          <li><strong>Time in Range:</strong> >70% (70-180 mg/dL)</li>
        </ul>
      </div>
    </div>

    <strong>üíâ Medication Classes</strong>
    <table style="width:100%; border-collapse: collapse; margin: 10px 0; font-size: 0.9rem;">
      <tr style="background-color: #f2f2f2;">
        <th>Class</th>
        <th>Examples</th>
        <th>A1C ‚Üì</th>
        <th>Key Benefits</th>
      </tr>
      <tr><td>Biguanides</td><td>Metformin</td><td>1-1.5%</td><td>First-line, weight neutral</td></tr>
      <tr><td>SGLT2i</td><td>Empagliflozin</td><td>0.5-1%</td><td>Cardio/renal protection</td></tr>
      <tr><td>GLP-1 RA</td><td>Semaglutide</td><td>1-1.5%</td><td>Weight loss, CV benefit</td></tr>
      <tr><td>Insulin</td><td>Various</td><td>1.5-3.5%</td><td>Most potent</td></tr>
    </table>

    <strong>üö® Diabetes Emergencies</strong>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 10px 0;">
      <div style="background-color: #fff3cd; padding: 10px; border-radius: 5px;">
        <strong>Hypoglycemia (<70 mg/dL)</strong>
        <ul>
          <li><strong>Mild:</strong> 15g fast carbs (4oz juice)</li>
          <li><strong>Severe:</strong> Glucagon IM if unconscious</li>
          <li><strong>Rebound:</strong> Protein snack after treatment</li>
        </ul>
      </div>
      <div style="background-color: #f8d7da; padding: 10px; border-radius: 5px;">
        <strong>DKA (BG >250 + ketones)</strong>
        <ul>
          <li>IV fluids + insulin drip</li>
          <li>Monitor K+ closely</li>
          <li>Search for precipitant</li>
        </ul>
      </div>
    </div>

    <strong>üçΩ Medical Nutrition Therapy</strong>
    <div style="background-color: #f8f9fa; padding: 10px; border-radius: 5px; margin: 10px 0;">
      <ul>
        <li><strong>Carb Counting:</strong> 45-60g per meal (consistent timing)</li>
        <li><strong>Plate Method:</strong> ¬Ω non-starchy veggies, ¬º protein, ¬º carbs</li>
        <li><strong>Fiber:</strong> ‚â•14g/1000kcal (improves glycemic control)</li>
      </ul>
    </div>`;
  }

  // ========== HEART DISEASE CARD ==========
  if (queryLower.includes('heart disease') || queryLower.includes('cad') || queryLower.includes('coronary')) {
    return disclaimer + `
    <img src="infohealth-professional-3.jpg" alt="Heart Disease Management" class="medical-image">
    
    <strong>CORONARY ARTERY DISEASE: COMPLETE GUIDE</strong><br><br>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
      <div>
        <strong>ü©∫ Diagnostic Workup</strong>
        <ul style="margin-top: 5px;">
          <li><strong>Stress Test:</strong> ECG changes, perfusion defects</li>
          <li><strong>Coronary CTA:</strong> Low-intermediate risk patients</li>
          <li><strong>Angiography:</strong> Gold standard for stenosis</li>
          <li><strong>Calcium Score:</strong> Agatston score ‚â•100 = increased risk</li>
        </ul>
      </div>
      <div>
        <strong>üíä Medical Therapy (AHA 2023)</strong>
        <ul style="margin-top: 5px;">
          <li><strong>High-Intensity Statin:</strong> Atorvastatin 40-80mg</li>
          <li><strong>Anti-platelets:</strong> Aspirin 81mg + Clopidogrel post-PCI</li>
          <li><strong>Beta-blockers:</strong> Metoprolol succinate post-MI</li>
          <li><strong>ACE-I/ARB:</strong> For LV dysfunction</li>
        </ul>
      </div>
    </div>

    <strong>‚ù§Ô∏è Cardiac Rehabilitation</strong>
    <div style="background-color: #f8f9fa; padding: 10px; border-radius: 5px; margin: 10px 0;">
      <ul>
        <li>36 sessions over 12 weeks</li>
        <li>Exercise training + education</li>
        <li>Mortality reduction up to 25%</li>
        <li>Underutilized (only 20-30% eligible patients)</li>
      </ul>
    </div>

    <strong>üö® Acute Coronary Syndrome</strong>
    <table style="width:100%; border-collapse: collapse; margin: 10px 0; font-size: 0.9rem;">
      <tr style="background-color: #f2f2f2;">
        <th>Type</th>
        <th>ECG</th>
        <th>Troponin</th>
        <th>Management</th>
      </tr>
      <tr><td>STEMI</td><td>ST ‚Üë</td><td>+</td><td>PCI within 90 mins</td></tr>
      <tr><td>NSTEMI</td><td>ST ‚Üì/T wave</td><td>+</td><td>PCI within 24-48h</td></tr>
      <tr><td>Unstable Angina</td><td>Normal/dynamic</td><td>-</td><td>Risk stratification</td></tr>
    </table>

    <strong>üîç Risk Factors (ASCVD Risk Calculator)</strong>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 10px 0;">
      <div>
        <strong>Non-Modifiable</strong>
        <ul>
          <li>Age (M >45, F >55)</li>
          <li>Male sex</li>
          <li>Family history</li>
        </ul>
      </div>
      <div>
        <strong>Modifiable</strong>
        <ul>
          <li>Hypertension</li>
          <li>Dyslipidemia</li>
          <li>Diabetes</li>
          <li>Smoking</li>
        </ul>
      </div>
    </div>`;
  }

  // ========== GENERAL WELLNESS CARD ==========
  if (queryLower.includes('wellness') || queryLower.includes('prevention') || queryLower.includes('healthy lifestyle')) {
    return disclaimer + `
    <img src="medical-professional-5.jpg" alt="Wellness Management" class="medical-image">
    
    <strong>PREVENTIVE HEALTH: COMPLETE GUIDE</strong><br><br>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
      <div>
        <strong>ü©∫ Screening Recommendations</strong>
        <ul style="margin-top: 5px;">
          <li><strong>BP:</strong> Annually if normal</li>
          <li><strong>Lipids:</strong> Every 5 years from age 20</li>
          <li><strong>Diabetes:</strong> Screen at 35+ (or if overweight)</li>
          <li><strong>Colon Cancer:</strong> Colonoscopy at 45+</li>
        </ul>
      </div>
      <div>
        <strong>üíâ Immunizations</strong>
        <ul style="margin-top: 5px;">
          <li><strong>Influenza:</strong> Annual</li>
          <li><strong>COVID-19:</strong> Per CDC guidelines</li>
          <li><strong>Shingles:</strong> ‚â•50 years (Shingrix)</li>
          <li><strong>Pneumococcal:</strong> ‚â•65 years</li>
        </ul>
      </div>
    </div>

    <strong>üçΩ Dietary Guidelines (USDA 2020-2025)</strong>
    <div style="background-color: #f8f9fa; padding: 10px; border-radius: 5px; margin: 10px 0;">
      <ul>
        <li><strong>Vegetables:</strong> 2.5 cups/day</li>
        <li><strong>Fruits:</strong> 2 cups/day</li>
        <li><strong>Whole Grains:</strong> ‚â•3 oz-equivalents/day</li>
        <li><strong>Dairy:</strong> 3 cups/day (low-fat)</li>
        <li><strong>Protein:</strong> 5.5 oz-equivalents/day</li>
      </ul>
    </div>

    <strong>üèÉ Physical Activity (WHO Guidelines)</strong>
    <table style="width:100%; border-collapse: collapse; margin: 10px 0; font-size: 0.9rem;">
      <tr style="background-color: #f2f2f2;">
        <th>Activity</th>
        <th>Frequency</th>
        <th>Duration</th>
      </tr>
      <tr><td>Aerobic</td><td>3-5x/week</td><td>30-60 mins</td></tr>
      <tr><td>Strength</td><td>2x/week</td><td>All major groups</td></tr>
      <tr><td>Flexibility</td><td>2-3x/week</td><td>10-15 mins</td></tr>
      <tr><td>Balance</td><td>3x/week</td><td>For fall prevention</td></tr>
    </table>

    <strong>üò¥ Sleep Hygiene</strong>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 10px 0;">
      <div>
        <strong>Do:</strong>
        <ul>
          <li>Consistent sleep schedule</li>
          <li>Cool, dark environment</li>
          <li>Wind-down routine</li>
        </ul>
      </div>
      <div>
        <strong>Avoid:</strong>
        <ul>
          <li>Caffeine after 2pm</li>
          <li>Screens before bed</li>
          <li>Alcohol near bedtime</li>
        </ul>
      </div>
    </div>`;
  }

  // [Additional cards can be added here following the same pattern]

  // DEFAULT RESPONSE
  return disclaimer + 'I specialize in <strong>Hypertension, Cholesterol, Diabetes, and Heart Disease</strong>.<br><br>Try asking about specific conditions, medications, or management strategies.';
}

      // PERSONAL HEALTH INFO MANAGEMENT
      if (queryLower.includes('personal health') || queryLower.includes('health information') || queryLower.includes('my info') ||
          queryLower.includes('health records') || queryLower.includes('medical history')) {
        
        return disclaimer + '<strong>üìã PERSONAL HEALTH INFORMATION MANAGEMENT</strong><br><br><strong>Essential Health Information to Track:</strong><ul><li><strong>Current Medications:</strong> Names, dosages, times taken, prescribing doctor</li><li><strong>Medical Conditions:</strong> Diagnoses, dates diagnosed, current status</li><li><strong>Allergies:</strong> Drug allergies, food allergies, reaction descriptions</li><li><strong>Emergency Contacts:</strong> Doctor numbers, family contacts, pharmacy</li><li><strong>Insurance Info:</strong> Card photos, member ID, group numbers</li></ul><br><strong>Key Health Numbers to Know:</strong><ul><li><strong>Blood Pressure Target:</strong> Your specific goal (usually under 130/80)</li><li><strong>Cholesterol Levels:</strong> Last LDL, HDL, triglyceride results</li><li><strong>HbA1c (if diabetic):</strong> Last 3-6 month average blood sugar</li><li><strong>Weight Goal:</strong> Target BMI or weight range</li><li><strong>Heart Rate Range:</strong> Resting and target exercise rates</li></ul><br><strong>Medical History Essentials:</strong><ul><li><strong>Family History:</strong> Parents/siblings with heart disease, diabetes, high BP</li><li><strong>Previous Procedures:</strong> Surgeries, cardiac procedures, hospitalizations</li><li><strong>Previous Medications:</strong> What worked, what caused side effects</li><li><strong>Baseline Tests:</strong> EKG, echocardiogram, stress test results</li></ul><br><strong>Health Information Security:</strong><ul><li><strong>Digital Copies:</strong> Photos of insurance cards, medication lists</li><li><strong>Secure Storage:</strong> Password-protected files or health apps</li><li><strong>Share Appropriately:</strong> Give copies to family members, caregivers</li><li><strong>Keep Updated:</strong> Review and update quarterly</li></ul>';
      }

      // MEDICAL APPOINTMENTS MANAGEMENT
      if (queryLower.includes('appointments') || queryLower.includes('doctor visit') || queryLower.includes('medical appointment') ||
          queryLower.includes('follow-up') || queryLower.includes('checkup')) {
        
        return disclaimer + '<strong>üè• MEDICAL APPOINTMENTS & FOLLOW-UP CARE</strong><br><br><strong>Routine Appointment Schedule:</strong><ul><li><strong>Primary Care:</strong> Every 6-12 months for chronic conditions</li><li><strong>Cardiologist:</strong> Every 3-6 months for heart disease patients</li><li><strong>Endocrinologist:</strong> Every 3-6 months for diabetes</li><li><strong>Eye Doctor:</strong> Annually for diabetics, every 2 years otherwise</li><li><strong>Dentist:</strong> Every 6 months (important for heart health)</li></ul><br><strong>Preparing for Doctor Visits:</strong><ul><li><strong>Medication List:</strong> Bring current list with dosages</li><li><strong>Symptom Log:</strong> Notes on any new or changing symptoms</li><li><strong>Question List:</strong> Write down questions beforehand</li><li><strong>Health Logs:</strong> Blood pressure, blood sugar, weight trends</li><li><strong>Insurance Card:</strong> Bring current card and ID</li></ul><br><strong>Important Lab Tests & Frequency:</strong><ul><li><strong>Blood Pressure Patients:</strong> Basic metabolic panel every 6-12 months</li><li><strong>Cholesterol:</strong> Lipid panel every 3-6 months until stable</li><li><strong>Diabetes:</strong> HbA1c every 3-6 months, annual kidney function</li><li><strong>Heart Disease:</strong> Various tests based on condition</li></ul><br><strong>After Your Appointment:</strong><ul><li><strong>Get Summary:</strong> Ask for written summary of visit</li><li><strong>Understand Instructions:</strong> Clarify any medication changes</li><li><strong>Schedule Follow-up:</strong> Book next appointment before leaving</li><li><strong>Fill Prescriptions:</strong> Get new medications promptly</li><li><strong>Follow Instructions:</strong> Implement any lifestyle changes discussed</li></ul>';
      }

      // MEDICATION MANAGEMENT
      if (queryLower.includes('medication management') || queryLower.includes('manage medications') || 
          queryLower.includes('pill organization') || queryLower.includes('medication safety') ||
          (queryLower.includes('medications') && !queryLower.includes('heart') && !queryLower.includes('diabetes'))) {
        
        return disclaimer + '<strong>üíä COMPREHENSIVE MEDICATION MANAGEMENT</strong><br><br><strong>Medication Organization System:</strong><ul><li><strong>Pill Organizers:</strong> Weekly organizers with AM/PM compartments</li><li><strong>Medication List:</strong> Keep updated list in wallet and on phone</li><li><strong>Set Reminders:</strong> Phone alarms for each medication time</li><li><strong>Refill Calendar:</strong> Mark refill dates on calendar</li><li><strong>Emergency Supply:</strong> Keep 7-day supply for emergencies</li></ul><br><strong>Safe Medication Practices:</strong><ul><li><strong>Take as Prescribed:</strong> Same time daily, don\'t skip or double doses</li><li><strong>Don\'t Stop Suddenly:</strong> Especially blood pressure and heart medications</li><li><strong>Read Labels Carefully:</strong> Check expiration dates and instructions</li><li><strong>Store Properly:</strong> Cool, dry place unless refrigeration needed</li><li><strong>Keep Original Bottles:</strong> For emergency identification</li></ul><br><strong>Critical Drug Interactions to Avoid:</strong><ul><li><strong>Blood Thinners + NSAIDs:</strong> Increases bleeding risk</li><li><strong>ACE Inhibitors + Potassium:</strong> Can cause dangerous high potassium</li><li><strong>Statins + Grapefruit:</strong> Increases medication levels</li><li><strong>Diabetes Meds + Alcohol:</strong> Risk of dangerous low blood sugar</li><li><strong>Multiple BP Meds:</strong> Can cause dangerously low blood pressure</li></ul><br><strong>When to Contact Your Doctor:</strong><ul><li><strong>Side Effects:</strong> New symptoms after starting medication</li><li><strong>Missed Doses:</strong> Unsure what to do if you miss doses</li><li><strong>Cost Issues:</strong> Can\'t afford medications</li><li><strong>Effectiveness:</strong> Medication doesn\'t seem to be working</li><li><strong>New Medications:</strong> Before starting any new drugs or supplements</li></ul><br><strong>Medication Cost-Saving Tips:</strong><ul><li><strong>Generic Options:</strong> Ask about generic versions</li><li><strong>Manufacturer Coupons:</strong> Check drug company websites</li><li><strong>Pharmacy Programs:</strong> Walmart $4 list, Costco, etc.</li><li><strong>Insurance Formulary:</strong> Choose preferred drugs when possible</li><li><strong>90-Day Supplies:</strong> Often cheaper than monthly refills</li></ul>';
      }

      // DEFAULT RESPONSE WITH SUGGESTIONS
      return disclaimer + 'I specialize in <strong>Hypertension, Cholesterol, Heart Disease, Diabetes, and Health Management</strong>.<br><br><strong>Popular Questions I Can Help With:</strong><ul><li>"My blood pressure is 150/95, what should I do?"</li><li>"How can I lower my cholesterol naturally?"</li><li>"What are the warning signs of a heart attack?"</li><li>"How do I control my blood sugar better?"</li><li>"How should I organize my medications?"</li><li>"What should I track in my health calendar?"</li><li>"How do I prepare for doctor appointments?"</li><li>"What health information should I keep?"</li><li>"When should I call 911 for chest pain?"</li><li>"Can I exercise with heart disease?"</li></ul><br><strong>Try asking about:</strong> Symptoms, medications, diet, exercise, emergency signs, natural treatments, health tracking, or appointment management.<br><br>Click the topic cards above for detailed information!';
    }

    // Send message with chat clearing (for card clicks)
    function sendMessageWithClear(preset) {
      clearChat(); // Clear previous conversation
      sendMessage(preset);
    }

    // Regular send message function (for typed messages)
    function sendMessage(preset) {
      const text = preset || userInput.value.trim();
      if (!text) return;

      // Add user message instantly
      addBubble(text, 'user', false);
      userInput.value = '';

      // Add bot response with typewriter effect after delay
      setTimeout(() => {
        const response = getMedicalResponse(text);
        addBubble(response, 'bot', true); // Enable typewriter effect
      }, 800);
    }

    // Enter key support
    userInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') sendMessage();
    });

    console.log('InfoHealth AI app initialized with enhanced natural language processing');

    // Health Management System - In-Memory Storage
    let healthData = {
      readings: [],
      goals: [],
      personalInfo: {},
      conditions: [],
      allergies: [],
      appointments: [],
      medications: []
    };

    // Modal Management Functions
    function showHealthCalendar() {
      document.getElementById('calendarModal').style.display = 'block';
      loadHealthReadings();
      loadHealthGoals();
      document.getElementById('readingTime').value = new Date().toISOString().slice(0, 16);
    }

    function showMyHealthInfo() {
      document.getElementById('healthInfoModal').style.display = 'block';
      loadPersonalInfo();
      loadMedicalConditions();
      loadAllergies();
    }

    function showAppointments() {
      document.getElementById('appointmentsModal').style.display = 'block';
      loadAppointments();
    }

    function showMedications() {
      document.getElementById('medicationsModal').style.display = 'block';
      loadMedications();
    }

    function closeModal(modalId) {
      document.getElementById(modalId).style.display = 'none';
    }

    // Close modal when clicking outside
    window.onclick = function(event) {
      if (event.target.classList.contains('modal')) {
        event.target.style.display = 'none';
      }
    }

    // Health Calendar Functions
    function addHealthReading() {
      const value = document.getElementById('readingValue').value;
      const type = document.getElementById('readingType').value;
      const time = document.getElementById('readingTime').value;
      
      if (value && time) {
        const reading = {
          id: Date.now(),
          value: value,
          type: type,
          time: time,
          date: new Date(time).toLocaleDateString()
        };
        
        healthData.readings.push(reading);
        loadHealthReadings();
        
        // Clear form
        document.getElementById('readingValue').value = '';
        document.getElementById('readingTime').value = new Date().toISOString().slice(0, 16);
      }
    }

    function loadHealthReadings() {
      const container = document.getElementById('healthReadings');
      container.innerHTML = '';
      
      healthData.readings.slice(-10).reverse().forEach(reading => {
        const div = document.createElement('div');
        div.className = 'reading-entry';
        div.innerHTML = `
          <strong>${reading.type}</strong>
          <span>${reading.value}</span>
          <span>${reading.date}</span>
          <button class="delete-btn" onclick="deleteReading(${reading.id})">Delete</button>
        `;
        container.appendChild(div);
      });
    }

    function deleteReading(id) {
      healthData.readings = healthData.readings.filter(r => r.id !== id);
      loadHealthReadings();
    }

    function addHealthGoal() {
      const goalText = document.getElementById('newGoal').value;
      if (goalText) {
        const goal = {
          id: Date.now(),
          text: goalText,
          completed: false,
          date: new Date().toLocaleDateString()
        };
        
        healthData.goals.push(goal);
        loadHealthGoals();
        document.getElementById('newGoal').value = '';
      }
    }

    function loadHealthGoals() {
      const container = document.getElementById('healthGoals');
      container.innerHTML = '';
      
      healthData.goals.forEach(goal => {
        const div = document.createElement('div');
        div.style.cssText = 'display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px; margin-bottom: 8px;';
        div.innerHTML = `
          <span style="${goal.completed ? 'text-decoration: line-through; color: #666;' : ''}">${goal.text}</span>
          <div>
            <button class="btn" style="padding: 5px 10px; margin-right: 5px;" onclick="toggleGoal(${goal.id})">${goal.completed ? 'Undo' : 'Complete'}</button>
            <button class="delete-btn" onclick="deleteGoal(${goal.id})">Delete</button>
          </div>
        `;
        container.appendChild(div);
      });
    }

    function toggleGoal(id) {
      const goal = healthData.goals.find(g => g.id === id);
      if (goal) {
        goal.completed = !goal.completed;
        loadHealthGoals();
      }
    }

    function deleteGoal(id) {
      healthData.goals = healthData.goals.filter(g => g.id !== id);
      loadHealthGoals();
    }

    // Personal Health Info Functions
    function saveHealthInfo() {
      healthData.personalInfo = {
        fullName: document.getElementById('fullName').value,
        dateOfBirth: document.getElementById('dateOfBirth').value,
        emergencyContact: document.getElementById('emergencyContact').value,
        bpGoal: document.getElementById('bpGoal').value,
        cholesterolGoal: document.getElementById('cholesterolGoal').value,
        bsGoal: document.getElementById('bsGoal').value,
        weightGoal: document.getElementById('weightGoal').value
      };
      alert('Health information saved successfully!');
    }

    function loadPersonalInfo() {
      const info = healthData.personalInfo;
      document.getElementById('fullName').value = info.fullName || '';
      document.getElementById('dateOfBirth').value = info.dateOfBirth || '';
      document.getElementById('emergencyContact').value = info.emergencyContact || '';
      document.getElementById('bpGoal').value = info.bpGoal || '';
      document.getElementById('cholesterolGoal').value = info.cholesterolGoal || '';
      document.getElementById('bsGoal').value = info.bsGoal || '';
      document.getElementById('weightGoal').value = info.weightGoal || '';
    }

    function addMedicalCondition() {
      const condition = document.getElementById('newCondition').value;
      if (condition) {
        healthData.conditions.push({
          id: Date.now(),
          name: condition,
          date: new Date().toLocaleDateString()
        });
        loadMedicalConditions();
        document.getElementById('newCondition').value = '';
      }
    }

    function loadMedicalConditions() {
      const container = document.getElementById('medicalConditions');
      container.innerHTML = '';
      
      healthData.conditions.forEach(condition => {
        const div = document.createElement('div');
        div.style.cssText = 'display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px; margin-bottom: 8px;';
        div.innerHTML = `
          <span><strong>${condition.name}</strong> <small>(Added: ${condition.date})</small></span>
          <button class="delete-btn" onclick="deleteCondition(${condition.id})">Delete</button>
        `;
        container.appendChild(div);
      });
    }

    function deleteCondition(id) {
      healthData.conditions = healthData.conditions.filter(c => c.id !== id);
      loadMedicalConditions();
    }

    function addAllergy() {
      const allergy = document.getElementById('newAllergy').value;
      if (allergy) {
        healthData.allergies.push({
          id: Date.now(),
          name: allergy,
          date: new Date().toLocaleDateString()
        });
        loadAllergies();
        document.getElementById('newAllergy').value = '';
      }
    }

    function loadAllergies() {
      const container = document.getElementById('allergiesList');
      container.innerHTML = '';
      
      healthData.allergies.forEach(allergy => {
        const div = document.createElement('div');
        div.style.cssText = 'display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px; margin-bottom: 8px;';
        div.innerHTML = `
          <span><strong>${allergy.name}</strong> <small>(Added: ${allergy.date})</small></span>
          <button class="delete-btn" onclick="deleteAllergy(${allergy.id})">Delete</button>
        `;
        container.appendChild(div);
      });
    }

    function deleteAllergy(id) {
      healthData.allergies = healthData.allergies.filter(a => a.id !== id);
      loadAllergies();
    }

    // Appointments Functions
    function addAppointment() {
      const doctor = document.getElementById('doctorName').value;
      const time = document.getElementById('appointmentTime').value;
      const type = document.getElementById('appointmentType').value;
      const phone = document.getElementById('doctorPhone').value;
      const notes = document.getElementById('appointmentNotes').value;
      
      if (doctor && time) {
        const appointment = {
          id: Date.now(),
          doctor: doctor,
          time: time,
          type: type,
          phone: phone,
          notes: notes,
          date: new Date(time).toLocaleDateString(),
          isPast: new Date(time) < new Date()
        };
        
        healthData.appointments.push(appointment);
        loadAppointments();
        
        // Clear form
        document.getElementById('doctorName').value = '';
        document.getElementById('appointmentTime').value = '';
        document.getElementById('doctorPhone').value = '';
        document.getElementById('appointmentNotes').value = '';
      }
    }

    function loadAppointments() {
      const upcomingContainer = document.getElementById('upcomingAppointments');
      const pastContainer = document.getElementById('pastAppointments');
      
      upcomingContainer.innerHTML = '';
      pastContainer.innerHTML = '';
      
      const now = new Date();
      
      healthData.appointments.forEach(appointment => {
        const appointmentDate = new Date(appointment.time);
        const isUpcoming = appointmentDate >= now;
        
        const div = document.createElement('div');
        div.className = 'health-card';
        div.style.cssText = 'background: white; margin-bottom: 10px;';
        div.innerHTML = `
          <h4 style="margin: 0 0 10px 0; color: ${isUpcoming ? '#DAA520' : '#666'};">${appointment.doctor}</h4>
          <p><strong>Date:</strong> ${new Date(appointment.time).toLocaleString()}</p>
          <p><strong>Type:</strong> ${appointment.type}</p>
          ${appointment.phone ? `<p><strong>Phone:</strong> ${appointment.phone}</p>` : ''}
          ${appointment.notes ? `<p><strong>Notes:</strong> ${appointment.notes}</p>` : ''}
          <button class="delete-btn" onclick="deleteAppointment(${appointment.id})">Delete</button>
        `;
        
        if (isUpcoming) {
          upcomingContainer.appendChild(div);
        } else {
          pastContainer.appendChild(div);
        }
      });
      
      if (upcomingContainer.children.length === 0) {
        upcomingContainer.innerHTML = '<p>No upcoming appointments scheduled.</p>';
      }
      
      if (pastContainer.children.length === 0) {
        pastContainer.innerHTML = '<p>No past appointments recorded.</p>';
      }
    }

    function deleteAppointment(id) {
      healthData.appointments = healthData.appointments.filter(a => a.id !== id);
      loadAppointments();
    }

    // Medications Functions
    function addMedication() {
      const name = document.getElementById('medicationName').value;
      const dosage = document.getElementById('medicationDosage').value;
      const frequency = document.getElementById('medicationFrequency').value;
      const time = document.getElementById('medicationTime').value;
      const doctor = document.getElementById('prescribingDoctor').value;
      const pharmacy = document.getElementById('pharmacy').value;
      const notes = document.getElementById('medicationNotes').value;
      
      if (name && dosage) {
        const medication = {
          id: Date.now(),
          name: name,
          dosage: dosage,
          frequency: frequency,
          time: time,
          doctor: doctor,
          pharmacy: pharmacy,
          notes: notes,
          dateAdded: new Date().toLocaleDateString()
        };
        
        healthData.medications.push(medication);
        loadMedications();
        
        // Clear form
        document.getElementById('medicationName').value = '';
        document.getElementById('medicationDosage').value = '';
        document.getElementById('medicationTime').value = '';
        document.getElementById('prescribingDoctor').value = '';
        document.getElementById('pharmacy').value = '';
        document.getElementById('medicationNotes').value = '';
      }
    }

    function loadMedications() {
      const container = document.getElementById('currentMedications');
      container.innerHTML = '';
      
      healthData.medications.forEach(medication => {
        const div = document.createElement('div');
        div.className = 'health-card';
        div.style.cssText = 'background: white; margin-bottom: 10px;';
        div.innerHTML = `
          <h4 style="margin: 0 0 10px 0; color: #DAA520;">${medication.name} ${medication.dosage}</h4>
          <p><strong>Frequency:</strong> ${medication.frequency}</p>
          ${medication.time ? `<p><strong>Time to Take:</strong> ${medication.time}</p>` : ''}
          ${medication.doctor ? `<p><strong>Prescribed by:</strong> ${medication.doctor}</p>` : ''}
          ${medication.pharmacy ? `<p><strong>Pharmacy:</strong> ${medication.pharmacy}</p>` : ''}
          ${medication.notes ? `<p><strong>Notes:</strong> ${medication.notes}</p>` : ''}
          <p><small>Added: ${medication.dateAdded}</small></p>
          <button class="delete-btn" onclick="deleteMedication(${medication.id})">Delete</button>
        `;
        container.appendChild(div);
      });
      
      if (healthData.medications.length === 0) {
        container.innerHTML = '<p>No medications added yet.</p>';
      }
    }

    function deleteMedication(id) {
      healthData.medications = healthData.medications.filter(m => m.id !== id);
      loadMedications();
    }
  </script>
</body>
</html>
